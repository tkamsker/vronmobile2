Solution Implemented

  I've fixed the CI/CD pipeline .env file issue with a comprehensive environment management solution. The problem was that pubspec.yaml referenced .env as an asset, but the file is gitignored and not available during CI/CD builds.

  What Was Done

  Commit: d671b5c - fix: implement comprehensive .env management for CI/CD and local development

  Changes:

  1. CI/CD Scripts:
    - scripts/generate-env.sh - Generates .env from GitHub Secrets during CI/CD
    - scripts/switch-env.sh - Switches between stage/main environments locally
  2. Workflow Updates:
    - Added .env generation step before builds in all workflow jobs
    - Configured environment-specific secrets for stage and main branches
  3. Configuration Updates:
    - Removed .env from pubspec.yaml assets (fixes build error)
    - Updated .gitignore to ignore all .env variants
    - Updated .env.example with setup instructions
    - Created ENV_SETUP.md with comprehensive documentation
  4. Environment Files (gitignored, for local use):
    - .env.stage - Stage environment configuration
    - .env.main - Production environment configuration

  Required GitHub Secrets

  Before the CI/CD pipeline can succeed, you need to configure these GitHub Secrets:

  Stage Branch:
  - VRON_API_URI_STAGE → https://api.vron.stage.motorenflug.at
  - VRON_MERCHANTS_URL_STAGE → https://app.vron.stage.motorenflug.at
  - BLENDER_API_BASE_URL_STAGE → https://blenderapi.stage.motorenflug.at
  - BLENDER_API_KEY_STAGE → Your stage API key

  Main Branch:
  - VRON_API_URI_MAIN → https://api.vron.motorenflug.at
  - VRON_MERCHANTS_URL_MAIN → https://app.vron.motorenflug.at
  - BLENDER_API_BASE_URL_MAIN → https://blenderapi.motorenflug.at
  - BLENDER_API_KEY_MAIN → Your production API key

  Shared:
  - APP_COOKIE_DOMAIN → .motorenflug.at

  To add secrets:
  1. Go to GitHub repository → Settings → Secrets and variables → Actions
  2. Click "New repository secret"
  3. Add each secret with its corresponding value

  Local Development Usage

  Switch between environments:
  # Use stage environment
  ./scripts/switch-env.sh stage

  # Use production environment
  ./scripts/switch-env.sh main

  The script will back up your current .env, copy the selected environment file, and show the active configuration.

  How CI/CD Works Now

  1. Workflow triggers on push to stage/main
  2. Checks out code (no .env present)
  3. Runs generate-env.sh which creates .env from GitHub Secrets
  4. Flutter build proceeds with generated .env
  5. .env is never committed back

  Documentation

  See ENV_SETUP.md for:
  - Complete setup instructions
  - Troubleshooting guide
  - Security best practices
  - Environment variables reference

  Next Steps

  1. Configure GitHub Secrets as listed above
  2. Re-run the CI/CD pipeline - should now pass
  3. Locally: Use ./scripts/switch-env.sh stage to switch environments

  The pipeline will fail until the GitHub Secrets are configured, but once they're set up, builds should work seamlessly for both stage and main branches.
